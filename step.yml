title: Rock Remote Build - iOS
summary: Build iOS apps using Rock.
description: |
  This step builds iOS apps with Rock, optionally re-signing IPAs
  for PRs or device builds. Code signing must be configured separately
  in your workflow before using this step.
website: https://github.com/callstackincubator/ios
source_code_url: https://github.com/callstackincubator/ios
support_url: https://github.com/callstackincubator/ios/issues

project_type_tags:
  - ios
  - react-native

type_tags:
  - build

toolkit:
  bash:
    entry_file: step.sh

deps:
  brew:
    - name: jq

inputs:
  - WORKING_DIRECTORY:
      opts:
        title: Working directory for the build
        summary: Path where the build command should be run
        description: Can be relative or absolute. Defaults to "."
        is_required: false
        is_expand: true
        value: "."

  - DESTINATION:
      opts:
        title: Destination for the build
        summary: "Use 'simulator' or 'device'. Code signing must be configured separately."
        is_required: true
        value: "simulator"

  - SCHEME:
      opts:
        title: Xcode scheme
        is_required: true
        value: ""

  - CONFIGURATION:
      opts:
        title: Xcode configuration
        is_required: true
        value: ""

  - RE_SIGN:
      opts:
        title: Re-sign IPA with new JS bundle
        summary: Requires certificates in keychain. No signing for simulator builds.
        is_required: false
        value: ""

  - AD_HOC:
      opts:
        title: Upload IPA for ad-hoc distribution
        is_required: false
        value: "false"

  - SIGNING_IDENTITY:
      opts:
        title: Code signing identity for re-signing
        summary: Optional. Auto-detects available certificates if not provided.
        is_required: false
        value: ""

  - ROCK_BUILD_EXTRA_PARAMS:
      opts:
        title: Extra parameters to pass to "rock build:ios"
        is_required: false
        value: ""

outputs:
  - ARTIFACT_URL:
      opts:
        title: URL of the built iOS artifact

  - ARTIFACT_ID:
      opts:
        title: ID of the built iOS artifact
